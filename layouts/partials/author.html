{{/* layouts/partials/author.html  â€” robust single-or-object author */}}
{{ $show := .Params.showAuthor | default (.Site.Params.article.showAuthor | default true) }}
{{ if not $show }}{{ return }}{{ end }}

{{/* Helper to normalize author from page or site into a dict with name/image/headline/bio */}}
{{ $norm := dict }}

{{/* Prefer page author if present */}}
{{ $pageAuthor := .Params.author }}
{{ if $pageAuthor }}
  {{ if eq (printf "%T" $pageAuthor) "string" }}
    {{ $norm = dict "name" (printf "%v" $pageAuthor) }}
  {{ else }}
    {{/* it's a map */}}
    {{ $norm = $pageAuthor }}
  {{ end }}
{{ else }}
  {{/* fall back to site author */}}
  {{ $siteAuthor := .Site.Params.author }}
  {{ if $siteAuthor }}
    {{ if eq (printf "%T" $siteAuthor) "string" }}
      {{ $norm = dict "name" (printf "%v" $siteAuthor) }}
    {{ else }}
      {{ $norm = $siteAuthor }}
    {{ end }}
  {{ end }}
{{ end }}

{{/* Extract fields safely */}}
{{ $name := (or ($norm.name) "Author") }}
{{ $headline := $norm.headline }}
{{ $bio := $norm.bio }}
{{ $imgPath := $norm.image }}

<footer class="article-author">
  <div class="flex items-center gap-4">
    {{ with $imgPath }}
      {{ $img := resources.Get . }}
      {{ with $img }}
        <img class="rounded-full" src="{{ (.Fit "96x96").RelPermalink }}" width="48" height="48" alt="{{ $name }}">
      {{ end }}
    {{ end }}
    <div>
      <div class="font-semibold">{{ $name }}</div>
      {{ with $headline }}<div class="text-sm opacity-80">{{ . | markdownify }}</div>{{ end }}
      {{ with $bio }}<div class="text-sm mt-1">{{ . | markdownify }}</div>{{ end }}
    </div>
  </div>
</footer>